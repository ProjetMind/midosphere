function newDestinataire(e,b){var d=jQuery("#participants-fields-list");var c=d.attr("data-prototype");c=c.replace(/__name__/g,e);e++;var a=jQuery("<li></li>").html(c);a.appendTo(jQuery("#participants-fields-list"));$("#participants-fields-list > li:last > input").attr("value",b.item.idUser);return e}function newDestinataireDeletable(f,c){var e=c.item.value;var b=document.getElementById("ulInputAutocomplete");var d=b.firstElementChild;var a='<button id="'+f+'" type="button" class="close" data-dismiss="alert">Ã—</button>'+e;var g=jQuery('<li class="alert alert-success"></li>').html(a);jQuery(g).insertBefore(d);return false}function deleteDestinataire(){jQuery("#ulInputAutocomplete").on("click",'button[class="close"]',function(){var a="mind_mpbundle_conversationtype_tabParticipants_"+this.id;jQuery("#"+a).parent().remove();this.parent().remove();return false})}function split(a){return a.split(/,\s*/)}function extractLast(a){return split(a).pop()}jQuery(function(){deleteDestinataire()});$(function(){$("#tabDestinataires").bind("keydown",function(a){if(a.keyCode===$.ui.keyCode.TAB&&$(this).data("ui-autocomplete").menu.active){}}).autocomplete({minLength:1,source:function(c,a){var b=Routing.generate("mind_message_nouveau_conversation_object",{terms:extractLast(c.term)});return $.ajax({type:"POST",dataType:"json",url:b,cache:false,success:function(d){a($.ui.autocomplete.filter(d,extractLast(c.term)))}})},html:true,messages:{noResults:"",results:function(){}},position:{my:"left top",at:"left bottom",collision:"none"},select:function(b,c){var a=split(this.value);a.pop();a.push(c.item.value);newDestinataireDeletable(emailCount,c);emailCount=newDestinataire(emailCount,c);this.value="";return false}})});